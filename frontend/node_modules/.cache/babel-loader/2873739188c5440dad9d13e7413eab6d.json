{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar Semaphore =\n/** @class */\nfunction () {\n  function Semaphore(_maxConcurrency) {\n    this._maxConcurrency = _maxConcurrency;\n    this._queue = [];\n\n    if (_maxConcurrency <= 0) {\n      throw new Error('semaphore must be initialized to a positive value');\n    }\n\n    this._value = _maxConcurrency;\n  }\n\n  Semaphore.prototype.acquire = function () {\n    var _this = this;\n\n    var locked = this.isLocked();\n    var ticket = new Promise(function (r) {\n      return _this._queue.push(r);\n    });\n    if (!locked) this._dispatch();\n    return ticket;\n  };\n\n  Semaphore.prototype.runExclusive = function (callback) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var _a, value, release;\n\n      return tslib_1.__generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this.acquire()];\n\n          case 1:\n            _a = _b.sent(), value = _a[0], release = _a[1];\n            _b.label = 2;\n\n          case 2:\n            _b.trys.push([2,, 4, 5]);\n\n            return [4\n            /*yield*/\n            , callback(value)];\n\n          case 3:\n            return [2\n            /*return*/\n            , _b.sent()];\n\n          case 4:\n            release();\n            return [7\n            /*endfinally*/\n            ];\n\n          case 5:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  Semaphore.prototype.isLocked = function () {\n    return this._value <= 0;\n  };\n\n  Semaphore.prototype.release = function () {\n    if (this._maxConcurrency > 1) {\n      throw new Error('this method is unavailabel on semaphores with concurrency > 1; use the scoped release returned by acquire instead');\n    }\n\n    if (this._currentReleaser) {\n      var releaser = this._currentReleaser;\n      this._currentReleaser = undefined;\n      releaser();\n    }\n  };\n\n  Semaphore.prototype._dispatch = function () {\n    var _this = this;\n\n    var nextConsumer = this._queue.shift();\n\n    if (!nextConsumer) return;\n    var released = false;\n\n    this._currentReleaser = function () {\n      if (released) return;\n      released = true;\n      _this._value++;\n\n      _this._dispatch();\n    };\n\n    nextConsumer([this._value--, this._currentReleaser]);\n  };\n\n  return Semaphore;\n}();\n\nexports.default = Semaphore;","map":{"version":3,"names":["Object","defineProperty","exports","value","tslib_1","require","Semaphore","_maxConcurrency","_queue","Error","_value","prototype","acquire","_this","locked","isLocked","ticket","Promise","r","push","_dispatch","runExclusive","callback","__awaiter","_a","release","__generator","_b","label","sent","trys","_currentReleaser","releaser","undefined","nextConsumer","shift","released","default"],"sources":["C:/Users/USER/Documents/demo-react/node_modules/async-mutex/lib/Semaphore.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar Semaphore = /** @class */ (function () {\n    function Semaphore(_maxConcurrency) {\n        this._maxConcurrency = _maxConcurrency;\n        this._queue = [];\n        if (_maxConcurrency <= 0) {\n            throw new Error('semaphore must be initialized to a positive value');\n        }\n        this._value = _maxConcurrency;\n    }\n    Semaphore.prototype.acquire = function () {\n        var _this = this;\n        var locked = this.isLocked();\n        var ticket = new Promise(function (r) { return _this._queue.push(r); });\n        if (!locked)\n            this._dispatch();\n        return ticket;\n    };\n    Semaphore.prototype.runExclusive = function (callback) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var _a, value, release;\n            return tslib_1.__generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this.acquire()];\n                    case 1:\n                        _a = _b.sent(), value = _a[0], release = _a[1];\n                        _b.label = 2;\n                    case 2:\n                        _b.trys.push([2, , 4, 5]);\n                        return [4 /*yield*/, callback(value)];\n                    case 3: return [2 /*return*/, _b.sent()];\n                    case 4:\n                        release();\n                        return [7 /*endfinally*/];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Semaphore.prototype.isLocked = function () {\n        return this._value <= 0;\n    };\n    Semaphore.prototype.release = function () {\n        if (this._maxConcurrency > 1) {\n            throw new Error('this method is unavailabel on semaphores with concurrency > 1; use the scoped release returned by acquire instead');\n        }\n        if (this._currentReleaser) {\n            var releaser = this._currentReleaser;\n            this._currentReleaser = undefined;\n            releaser();\n        }\n    };\n    Semaphore.prototype._dispatch = function () {\n        var _this = this;\n        var nextConsumer = this._queue.shift();\n        if (!nextConsumer)\n            return;\n        var released = false;\n        this._currentReleaser = function () {\n            if (released)\n                return;\n            released = true;\n            _this._value++;\n            _this._dispatch();\n        };\n        nextConsumer([this._value--, this._currentReleaser]);\n    };\n    return Semaphore;\n}());\nexports.default = Semaphore;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}